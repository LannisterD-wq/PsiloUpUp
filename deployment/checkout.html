<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Checkout | PsiloUp</title>
    <link rel="stylesheet" href="assets/css/main.css" />
    <link rel="stylesheet" href="assets/css/psiloup.css" />
    <link rel="stylesheet" href="assets/css/psiloup-modern.css" />
    <link rel="stylesheet" href="assets/css/fontawesome-all.min.css" />
    <script>
      window.PSILOUP_API_BASE = 'https://psiloupback-production.up.railway.app/api';
    </script>
  </head>
  <body>
    <header class="site-header">
      <div class="container site-header__wrap">
        <nav class="site-nav">
          <ul class="site-nav__list">
            <li><a href="index.html#packs">Produtos</a></li>
            <li><a href="formulacao.html">Formulação</a></li>
            <li><a href="quem-somos.html">Quem somos</a></li>
          </ul>
        </nav>
        <a class="site-logo" href="index.html" aria-label="PsiloUp">
          <img src="images/PsiloUp_logo_sem_fundo.png" alt="PsiloUp" />
        </a>
        <div class="site-actions">
          <a class="site-actions__link" href="account.html">Minha conta</a>
          <a class="site-actions__icon" href="#search" aria-label="Pesquisar"><i class="fas fa-search"></i></a>
          <a class="site-actions__icon" href="account.html" aria-label="Conta"><i class="far fa-user"></i></a>
          <a class="site-actions__icon" href="#cart" aria-label="Carrinho"><i class="fas fa-shopping-basket"></i></a>
        </div>
      </div>
    </header>

    <main>
      <section class="hero hero--catalog">
        <div class="container">
          <header class="hero__catalog-header">
            <h1>Finalizar compra</h1>
            <p>Fluxo simples: login/cadastro, cálculo de frete e pagamento.</p>
          </header>
        </div>
      </section>

      <section class="container stack" id="checkout">
        <!-- Etapa 1: Login/Cadastro -->
        <article class="bundle-card" id="step-account">
          <h3>1) Login ou cadastro</h3>
          <p>Informe seu e-mail para continuar. Se já estiver logado, vamos te reconhecer automaticamente.</p>
          <div class="cart-row">
            <input type="email" id="account-email" class="cart-buyer__email" placeholder="E-mail" aria-label="E-mail" />
            <button class="button button--primary" id="account-continue">Continuar</button>
          </div>
          <small id="account-message" aria-live="polite"></small>
        </article>

        <!-- Etapa 2: Cálculo de frete -->
        <article class="bundle-card" id="step-shipping">
          <h3>2) Calcular frete</h3>
          <p>Digite seu CEP para calcular o frete e habilitar o pagamento.</p>
          <div class="cart-row">
            <input type="text" id="shipping-cep" class="cart-cep__input" placeholder="CEP (somente números)" aria-label="CEP" />
            <button class="button button--primary" id="shipping-calc">Calcular</button>
          </div>
          <div id="shipping-options" class="shipping-options" style="display:none; margin-top: 10px;"></div>
          <small id="shipping-message" aria-live="polite"></small>
        </article>

        <!-- Etapa 3: Revisão e pagamento -->
        <article class="bundle-card" id="step-review">
          <h3>3) Revisar e pagar</h3>
          <div class="cart-summary">
            <div id="checkout-items"></div>
            <div class="cart-row"><span>Subtotal</span><strong class="cart-subtotal__value" id="checkout-subtotal">R$ 0,00</strong></div>
            <div class="cart-row"><span>Desconto</span><strong class="cart-discount__value" id="checkout-discount">R$ 0,00</strong></div>
            <div class="cart-row"><span>Frete</span><strong class="cart-shipping__value" id="checkout-shipping">Calcule com o CEP</strong></div>
            <div class="cart-total"><span>Total</span><strong class="cart-total__value" id="checkout-total">R$ 0,00</strong></div>
          </div>
          <div class="bundle-card__cta" id="address-select" style="margin-top: 16px;">
            <h4>Endereço de entrega</h4>
            <div id="address-list"></div>
            <button class="button" id="address-add">Adicionar novo endereço</button>
            <small id="address-message"></small>
          </div>
          <div class="bundle-card__cta">
            <button class="button button--primary" id="checkout-pay">Pagar com Mercado Pago</button>
          </div>
          <small id="checkout-message" aria-live="polite"></small>
        </article>
      </section>
    </main>

    <footer class="wrapper style1-alt">
      <div class="inner">
        <ul class="menu">
          <li>&copy; PsiloUp. Todos os direitos reservados.</li>
        </ul>
      </div>
    </footer>

    <script src="assets/js/core/config.js"></script>
    <script src="assets/js/core/auth.js"></script>
    <script src="assets/js/core/api.js"></script>
    <script src="assets/js/core/catalog.js"></script>
    <script src="assets/js/core/cart.js"></script>
    <script src="assets/js/psiloup-modern.js"></script>
    <script src="assets/js/auth.js"></script>
    <script src="assets/js/checkout-new.js"></script>
  </body>
</html>